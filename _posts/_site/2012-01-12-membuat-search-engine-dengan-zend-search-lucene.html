<p>Setelah sekian lama tidak mengisi blog, akhirnya baru ada niat ngisi blog lagi. kali ini saya akan mengangkat topik yang berbeda dengan sebelumnya <a title="Belajar MyBatis 3" href="http://www.jefri-p.com/2011/11/belajar-mybatis-3/">belajar mybatis 3</a> yaitu Membuat Search Engine dengan Zend Search Lucene. Saya membuat tutorial di karena kan karena ada tugas Temu Kembali Informasi (TKI), ya lagi-lagi tugas kuliah (namanya juga anak kuliahan).<br />
<!--more--><br />
<a href="http://www.jefri-p.com/wp-content/uploads/2012/01/Lucene21.png"><img class="aligncenter size-full wp-image-70" title="Zend_Search_Lucene" alt="" src="assets/Lucene21.png" width="287" height="127" /></a></p>
<p>Zend_Search_Lucene adalah full-text search engine framework porting dari <a title="Apache Lucene" href="http://lucene.apache.org">Apache Lucene</a> dan bagian dari <a href="http://framework.zend.com/">Zend Framework </a>, Anda dapat mendownload di web tersebut . Zend_Search_Lucene menjanjikan cara sederhana untuk menambahkan fungsi pencarian ke aplikasi tanpa membutuhkan tambahan ekstensi php atau bahkan database.</p>
<p>Langsung saja kita praktikan</p>
<p><strong>1. Membuat Index</strong><br />
Sebelum kita mencari data terlebih dahulu Anda harus membuat <a href="http://en.wikipedia.org/wiki/Index_(search_engine)">Indexing</a> yang akan mengumpulkan, mem-parsing, dan menyimpan data untuk memudahkan pencarian informasi yang cepat dan akurat</p>
<p>Disini kita akan mencoba mengindex file xml</p>
<p>File data.xml</p>
<p>[xml]<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;<br />
&lt;documents&gt;<br />
 &lt;document&gt;<br />
 &lt;id&gt;1&lt;/id&gt;<br />
 &lt;title&gt;first title on document&lt;/title&gt;<br />
 &lt;content&gt;Ilkomers content &lt;/content&gt;<br />
 &lt;published&gt;1012325463&lt;/published&gt;<br />
 &lt;/document&gt;<br />
 &lt;document&gt;<br />
 &lt;id&gt;3&lt;/id&gt;<br />
 &lt;title&gt;Search Lucene by Jefri Rahmat Yusuf &lt;/title&gt;<br />
 &lt;content&gt;tki search lucene from xml data&lt;/content&gt;<br />
 &lt;published&gt;1012356463&lt;/published&gt;<br />
 &lt;/document&gt;<br />
 &lt;document&gt;<br />
 &lt;id&gt;4&lt;/id&gt;<br />
 &lt;title&gt;Temu Kembali Informasi&lt;/title&gt;<br />
 &lt;content&gt;Temu kembali informasi (tki) with lucene by Jefri Rahmat Yusuf another document&lt;/content&gt;<br />
 &lt;published&gt;1012445463&lt;/published&gt;<br />
 &lt;/document&gt;<br />
 &lt;document&gt;<br />
 &lt;id&gt;6&lt;/id&gt;<br />
 &lt;title&gt;another Title in Lucene&lt;/title&gt;<br />
 &lt;content&gt;This is another document for lucene&lt;/content&gt;<br />
 &lt;published&gt;1013325467&lt;/published&gt;<br />
 &lt;/document&gt;<br />
&lt;/documents&gt;<br />
[/xml]</p>
<p>File indexing.php</p>
<p>[php]<br />
&lt;?php<br />
require_once 'Zend/Search/Lucene.php';</p>
<p>function sanitize($input) {<br />
 return htmlentities(strip_tags( $input ));<br />
}</p>
<p>$xml = 'data.xml';<br />
//cek file xml<br />
if (file_exists($xml)){<br />
 $xml = simplexml_load_file($xml);<br />
} else {<br />
 exit('Error.');<br />
}</p>
<p>//directory data temporary untuk indexing<br />
$xml_index = 'index/xml_index';</p>
<p>$index = new Zend_Search_Lucene($xml_index,true);<br />
// index setiap item<br />
 foreach ($xml as $item) {<br />
 if ($item-&gt;title &amp;&amp; $item-&gt;content) {<br />
 $doc = new Zend_Search_Lucene_Document();</p>
<p>$doc-&gt;addField(Zend_Search_Lucene_Field::Keyword('title',sanitize($item-&gt;title)));<br />
 $doc-&gt;addField(Zend_Search_Lucene_Field::Text('content',sanitize($item-&gt;content)));<br />
 $doc-&gt;addField(Zend_Search_Lucene_Field::UnIndexed('published',sanitize($item-&gt;published)));</p>
<p>echo &quot;\tMengindex: &lt;b&gt;&quot;.$item-&gt;title.&quot;&lt;/b&gt;&lt;br/&gt;&quot;;<br />
 $index-&gt;addDocument($doc);<br />
 }<br />
 }<br />
$index-&gt;commit();<br />
echo '&lt;br/&gt;'.$index-&gt;count().&quot; Dokumen terindex.\n&quot;;<br />
?&gt;<br />
[/php]</p>
<p>Pertama yang dilakukan adalah cek file xml</p>
<p>[php]<br />
$xml = 'data.xml';<br />
//cek file xml<br />
if (file_exists($xml)){<br />
 $xml = simplexml_load_file($xml);<br />
} else {<br />
 exit('Error.');<br />
}<br />
[/php]</p>
<p>Lalu tentukan directori untuk menampung data indexing</p>
<p>[php]<br />
//directory data temporary untuk indexing<br />
$xml_index = 'index/xml_index';<br />
[/php]</p>
<p>Lalu indexing data xml</p>
<p>[php]<br />
$index = new Zend_Search_Lucene($xml_index,true);<br />
// index setiap item<br />
 foreach ($xml as $item) {<br />
 if ($item-&gt;title &amp;&amp; $item-&gt;content) {<br />
 //buat dan index dokumen<br />
 }<br />
 }<br />
$index-&gt;commit();<br />
echo '&lt;br/&gt;'.$index-&gt;count().&quot; Dokumen terindex.\n&quot;;<br />
[/php]</p>
<p>Untuk membuat dokumen ke index, kita harus membuat document object dan field konten yang spesifik yang akan kita index, dalam hal ini kita akan mengindex title, content dan published.</p>
<p>[php]<br />
$doc-&gt;addField(Zend_Search_Lucene_Field::Keyword('title',sanitize($item-&gt;title)));<br />
 $doc-&gt;addField(Zend_Search_Lucene_Field::Text('content',sanitize($item-&gt;content)));<br />
 $doc-&gt;addField(Zend_Search_Lucene_Field::UnIndexed('published',sanitize($item-&gt;published)));</p>
<p>echo &quot;\tMengindex: &lt;b&gt;&quot;.$item-&gt;title.&quot;&lt;/b&gt;&lt;br/&gt;&quot;;<br />
 $index-&gt;addDocument($doc);<br />
[/php]</p>
<p>Item-item yang akan di index terlebih dahulu di sanitasi (sanitize). Berikut adalah keterangan dari masing-masing Zend_Search_Lucene_Field</p>
<p>Zend_Search_Lucene_Field::Keyword // Field is not tokenized, but is indexed and stored within the index.</p>
<p>Zend_Search_Lucene_Field::UnIndexed // Field is not tokenized nor indexed, but is stored in the index.</p>
<p>Zend_Search_Lucene_Field::Binary // Binary String valued Field that is not tokenized nor indexed, but is stored in the index.</p>
<p>Zend_Search_Lucene_Field::Text<br />
// Field is tokenized and indexed, and is stored in the index.</p>
<p>Zend_Search_Lucene_Field::UnStored<br />
// Field is tokenized and indexed, but is not stored in the index.</p>
<p><strong>2. Pencarian Index</strong></p>
<p>Sebelumnya kita sudah membuat Zend_Search_Lucene index pada data, mari kita implementasikan pencarian.</p>
<p>[php]</p>
<p>&lt;?php<br />
require_once 'Zend/Search/Lucene.php';</p>
<p>//buka file index<br />
$index = new Zend_Search_Lucene('index/xml_index');</p>
<p>$query = 'jefri';</p>
<p>if(strlen($query)&lt;4)<br />
 {<br />
 die('Kata-kata harus lebih dari 3 huruf');<br />
 }</p>
<p>$hits = $index-&gt;find($query);<br />
 echo &quot;Index Mempunyai &quot;.$index-&gt;count().&quot; dokumen.&lt;br/&gt;&quot;;<br />
 echo &quot;Pencarian untuk query '&quot;.$query.&quot;' menghasilkan &quot; .count($hits). &quot; hits&lt;br/&gt;&quot;;</p>
<p>foreach ($hits as $hit) {<br />
 echo &quot;&lt;pre&gt;&quot;;<br />
 echo $hit-&gt;title.&quot;&lt;br/&gt;&quot;;<br />
 echo $hit-&gt;content.&quot;&lt;br/&gt;&quot;;<br />
 echo &quot;\tScore: &quot;.sprintf('%.2f', $hit-&gt;score).&quot;&lt;br/&gt;&quot;;<br />
 }<br />
?&gt;<br />
[/php]</p>
<p>Kita include library , dan buka file index dan cari term lalu looping hasil, kita dapat melakukan pencarian query dengan <a href="http://framework.zend.com/manual/en/zend.search.lucene.query-language.html">multiple query terms</a>.</p>
<p>Zend_Search_Lucene sangat Powerfull dan simpel, untuk dokumentasi lengkap dapat dilihat di file document yang ada di Zend Framework atau <a href="http://framework.zend.com/manual/en/zend.search.lucene.html">http://framework.zend.com/manual/en/zend.search.lucene.html</a>.</p>
<p>Sekian.</p>
<p>sumber bacaan : <a href="http://devzone.zend.com/397/roll-your-own-search-engine-with-zend_search_lucene/">http://devzone.zend.com/397/roll-your-own-search-engine-with-zend_search_lucene/</a></p>
