---
layout: post
title: 'Kohana Framework 3.x : Error zlib output compression'
date: 2013-12-09 03:31:15.000000000 +07:00
categories:
- PHP
- Programming
tags:
- kohana
- zlib.output_compression
status: publish
type: post
published: true
meta:
  _edit_last: '863'
  _syntaxhighlighter_encoded: '1'
  dsq_thread_id: '2036816226'
author:
  login: jefri.p
  email: jefri.p@ui.edu
  display_name: Jefri Pakpahan
  first_name: Jefri
  last_name: Pakpahan
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<h2>PROBLEM</h2>
<p>Error message</p>
<blockquote><p>"ob_end_flush() [<a href="ref.outcontrol">ref.outcontrol</a>]: failed to delete buffer zlib output compression"</p></blockquote>
<p>Error terjadi pada saat saya menggunakan fungsi $response-&gt;send_file() , header file berubah alhasil file menjadi korup.<br />
Saya cek php.ini zlib.output_compression = On<!--more--><br />
Sudah mencoba yang disarankan <a href="http://code.iviable.com/2011/11/09/zlib-output_compression-with-ini_set-doesnt-work-as-expected/" target="_blank">http://code.iviable.com/2011/11/09/zlib-output_compression-with-ini_set-doesnt-work-as-expected/</a> tetapi tetap tidak dapat jalan.<br /></p>
<h2>SOLUSI</h2>
<p>File system\classes\Kohana\Response.php dapat di patch pada line 506 - 510<br />
[php firstline="506"]<br />
while (ob_get_level())<br />
{<br />
	// Flush all output buffers<br />
	ob_end_flush();<br />
}<br />
[/php]<br />
Diganti dengan patch dari <a href="https://github.com/bcosca/fatfree/issues/262#issuecomment-13414180" target="_blank">https://github.com/bcosca/fatfree/issues/262#issuecomment-13414180</a><br />
[php firstline="506"]<br />
if (!count(array_diff(ob_list_handlers(),array('default output handler'))))<br />
    ob_clean();<br />
[/php]</p>
<p>Atau jika tidak menggunakan kompresi dapat diubah php.ini menjadi<br />
zlib.output_compression = Off</p>
